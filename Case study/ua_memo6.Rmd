---
title: "UA_memo6"
author: "Henrique Sposito"
date: "2024-06-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
```

```{r}
WHO_reform_speeches <- read_csv("Case study/WHO_reform_speeches.csv")
# Urgency for any text
get_urgency(WHO_reform_speeches)
# Urgency for promises
urgency_promises <- get_urgency(select_promises(WHO_reform_speeches$text))
# Get topic
urgency_promises$CAP_topic <- gather_topics(urgency_promises) 
# Get more urgent topics
urgency_promises[order(urgency_promises$urgency, decreasing = TRUE),]
# Rank by topics
urgency_promises |>
  dplyr::mutate(CAP_topic = ifelse(CAP_topic == "", "No topic", CAP_topic)) |>
  tidyr::separate_rows(CAP_topic, sep = ", ") |>
  group_by(CAP_topic) |>
  dplyr::summarise(urgency_mean = mean(urgency),
                   urgency_median = stats::median(urgency),
                   urgency_sum = sum(urgency)) |>
  dplyr::arrange(-urgency_mean)
```
